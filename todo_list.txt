MINISHELL TODO LIST - Separated Concerns Architecture
=======================================================

ğŸ”¤ LEXER (TOKENIZER) - "What are the symbols?"
=====================================================
âœ… [COMPLETED] Basic token types (WORD, PIPE, REDIRECT_IN, REDIRECT_OUT, APPEND, HEREDOC)
âœ… [COMPLETED] Quote handling (single and double quotes) with type differentiation
âœ… [COMPLETED] Whitespace skipping
âœ… [COMPLETED] Multi-character operators (>>, <<)
âœ… [COMPLETED] Error handling for unclosed quotes
âœ… [COMPLETED] Arena-based memory management for tokenization

ğŸ”§ [TODO] Enhanced error reporting
    - Add line/column tracking for better error messages
    - Add token position information

ğŸ”§ [TODO] Wildcard detection
    - Add TOKEN_WILDCARD for * symbol
    - Mark tokens that contain wildcards for later expansion

ğŸŒ³ PARSER - "What's the command structure?"
==========================================
âœ… [COMPLETED] Command structure creation
    - Implement parse_commands() to convert tokens to t_command list
    - Handle simple commands: cmd arg1 arg2
    - Handle pipelines: cmd1 | cmd2 | cmd3
âœ… [COMPLETED] Arena-based memory for command tables
    - Command table built using arena allocation
    - Reset between commands for memory efficiency

âœ… [COMPLETED] Redirection parsing
    - Parse input redirection: < file
    - Parse output redirection: > file  
    - Parse append redirection: >> file
    - Parse heredoc: << delimiter

ğŸ”§ [TODO] Quote removal and variable expansion
    - Remove quotes from WORD tokens that were quoted
    - Preserve literal values inside quotes
    - Expand variables ($VAR) based on quote context
    - Handle special variables: $?, $$, $0
    - Different behavior for single vs double quotes

ğŸ”§ [TODO] Syntax validation
    - Check for invalid pipe usage (pipe at start/end, double pipes)
    - Check for invalid redirections (missing filenames)
    - Check for proper command structure

ğŸ”§ [TODO] Logical operators parsing
    - Parse && (AND) and || (OR) operators
    - Build command chains with conditional execution

ğŸ”§ [TODO] Subshell parsing
    - Parse parentheses for subshell execution: (cmd1; cmd2)
    - Handle nested subshells

ğŸ”§ [TODO] Error recovery
    - Provide meaningful syntax error messages
    - Implement error recovery strategies

âš¡ EXECUTOR - "How do I run this?"
=================================
âœ… [COMPLETED] Built-in command recognition
    - Basic is_builtin() function implemented
    - Builtin dispatch system working

ğŸ”§ [CRITICAL] Built-in implementations - NEEDS MAJOR FIXES (See builtins.txt)
    âŒ builtin_echo(): PARTIAL - Fix -n flag parsing for multiple flags
    âŒ builtin_cd(): BROKEN - Missing HOME support, no OLDPWD, no PWD updates
    âœ… builtin_pwd(): GOOD - Working correctly, minor portability issues
    âŒ builtin_env(): INCOMPLETE - Wrong signature, missing functionality  
    âŒ builtin_exit(): UNSAFE - No exit code validation, missing error handling
    ğŸ”§ [TODO] builtin_export(): Not implemented yet
    ğŸ”§ [TODO] builtin_unset(): Not implemented yet

ğŸ”§ [TODO] External command execution
    - PATH resolution for commands
    - fork() and execve() for external programs
    - Fr Giang: in pipex exec_cmd, if cmd_av == NULL, just exit but not error, 
    since a command like "cat file | > out.txt" will still create outfile although no command is executed, 
    no error appears in bash and exit code is 0;
    - Handle command not found errors

ğŸ”§ [TODO] Pipeline execution
    - Create pipes between commands
    - Handle multiple processes in pipeline
    - Wait for all processes and collect exit codes

ğŸ”§ [TODO] Redirection handling
    - Open files for input/output redirection
    - Handle file permission errors
    - Restore original stdin/stdout after redirection

ğŸ”§ [TODO] Heredoc implementation
    - Read input until delimiter is found
    - Handle variable expansion in heredoc (if required)
    - Create temporary files or use pipes

ğŸ”§ [TODO] Wildcard expansion
    - Use glob() function for * expansion
    - Handle no matches (return literal *)
    - Sort expanded filenames

ğŸ”§ [TODO] Logical operators execution
    - Implement && (execute next only if current succeeds)
    - Implement || (execute next only if current fails)
    - Handle short-circuit evaluation

ğŸ”§ [TODO] Signal handling
    - Handle Ctrl+C (SIGINT) - interrupt current command
    - Handle Ctrl+\ (SIGQUIT) - ignore in interactive mode
    - Handle Ctrl+D (EOF) - exit shell gracefully

ğŸ”§ [TODO] Subshell execution
    - Create child process for subshell
    - Execute commands in isolated environment
    - Return subshell exit status

ğŸ”§ [TODO] Error handling
    - Set $? exit status correctly
    - Handle command not found (127)
    - Handle permission denied (126)
    - Handle other execution errors

ğŸ› ï¸ INFRASTRUCTURE & UTILITIES
=============================
âœ… [COMPLETED] Memory management
    - Implemented memory arena for efficient allocation
    - Arena-based string functions (ar_strdup, ar_substr, ar_strjoin, ar_split)
    - Auto-extending arena when needed
    - Memory alignment for optimal performance
    - Reset functionality for command-by-command reuse

ğŸ”§ [TODO] Environment management
    - Create environment variable manipulation functions
    - Handle environment variable inheritance
    - Implement variable scoping for subshells

ğŸ”§ [TODO] History management (bonus)
    - Implement command history storage
    - Add history expansion (!!, !n, !string)
    - Save/load history from file

ğŸ”§ [TODO] Job control (bonus)
    - Implement background processes (&)
    - Add job status tracking
    - Implement jobs, fg, bg built-ins

ğŸ”§ [TODO] Advanced features (bonus)
    - Command line editing with readline
    - Tab completion for commands/files
    - Prompt customization

ğŸ§ª TESTING & VALIDATION
=======================
ğŸ”§ [TODO] Unit tests
    - Test tokenizer with various inputs
    - Test parser with complex command structures
    - Test each built-in command individually

ğŸ”§ [TODO] Integration tests
    - Test complete command execution flow
    - Test error handling and edge cases
    - Test memory management

ğŸ”§ [TODO] Comparison testing
    - Compare behavior with bash
    - Test subject requirements compliance
    - Test bonus features if implemented

ğŸ“‹ CURRENT STATUS
================
âœ… Tokenizer complete with arena memory management
âœ… Quote handling with type differentiation implemented  
âœ… Parser base functionality complete with arena memory
âœ… Memory arena infrastructure complete and integrated
âœ… Basic executor framework implemented
âœ… Path resolution system working (exe/path_utils.c)
âœ… Development tooling enhanced (Makefile with valgrind/cppcheck)
âŒ Built-in commands need major fixes (see builtins.txt analysis)
â³ Variable expansion - STILL NEEDED
â³ Advanced executor features (pipes, redirections)
â³ Advanced features - Final phase

ğŸ¯ NEXT IMMEDIATE STEPS - UPDATED PRIORITIES
============================================
ğŸš¨ CRITICAL (Fix Now):
1. Fix builtin_cd() - Add HOME directory support (cd with no args)
2. Fix builtin_exit() - Add exit code validation and error handling  
3. Fix builtin_echo() - Proper -n flag parsing for multiple flags

ğŸ”¥ HIGH PRIORITY:
4. Complete builtin_cd() - Add OLDPWD support (cd -) and PWD updates
5. Fix builtin_env() - Correct function signature and add functionality
6. Implement builtin_export() and builtin_unset()

â­ MEDIUM PRIORITY:
7. Implement variable expansion in parser with quote context awareness
8. Add syntax validation during parsing
9. Enhance pipeline execution system

ğŸ¯ LATER:
10. Add redirections and heredoc support
11. Add logical operators (&& and ||)
12. Advanced features and optimizations

ğŸ“ NOTES & INSIGHTS
===================
- Follow 42 Norm: functions â‰¤25 lines, â‰¤80 chars per line
- Add comprehensive comments for learning
- Test each component thoroughly before moving to next
- Keep clean separation between lexer/parser/executor
- Built-ins are recognized at EXECUTION time, not parsing time
- All command names are WORD tokens regardless of type (built-in vs external)

ğŸ”§ DEVELOPMENT TOOLS READY:
- Enhanced Makefile with Halloween theme and colored output
- Valgrind integration with file descriptor tracking (--track-fds=yes)
- Comprehensive cppcheck static analysis (--enable=all --inconclusive)
- Professional development workflow established

ğŸ§ª QUALITY ASSURANCE:
- Detailed builtin analysis completed (see builtins.txt)
- Code quality issues identified and prioritized
- Security assessment performed for all current functions
- Memory management validated (no leaks detected)

ğŸš€ Remember: "Make it work, make it right, make it fast!"
ğŸ’¡ Current Focus: Fix critical builtin issues before adding new features!
