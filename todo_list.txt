MINISHELL TODO LIST - Separated Concerns Architecture
=======================================================

ğŸ”¤ LEXER (TOKENIZER) - "What are the symbols?"
=====================================================
âœ… [COMPLETED] Basic token types (WORD, PIPE, REDIRECT_IN, REDIRECT_OUT, APPEND, HEREDOC)
âœ… [COMPLETED] Quote handling (single and double quotes) with type differentiation
âœ… [COMPLETED] Whitespace skipping
âœ… [COMPLETED] Multi-character operators (>>, <<)
âœ… [COMPLETED] Error handling for unclosed quotes
âœ… [COMPLETED] Arena-based memory management for tokenization

ğŸ”§ [TODO] Enhanced error reporting
    - Add line/column tracking for better error messages
    - Add token position information

ğŸ”§ [TODO] Wildcard detection
    - Add TOKEN_WILDCARD for * symbol
    - Mark tokens that contain wildcards for later expansion

ğŸŒ³ PARSER - "What's the command structure?"
==========================================
âœ… [COMPLETED] Command structure creation
    - Implement parse_commands() to convert tokens to t_command list
    - Handle simple commands: cmd arg1 arg2
    - Handle pipelines: cmd1 | cmd2 | cmd3
âœ… [COMPLETED] Arena-based memory for command tables
    - Command table built using arena allocation
    - Reset between commands for memory efficiency

âœ… [COMPLETED] Redirection parsing
    - Parse input redirection: < file
    - Parse output redirection: > file  
    - Parse append redirection: >> file
    - Parse heredoc: << delimiter

âœ… [COMPLETED] Quote removal and variable expansion
    - Remove quotes from WORD tokens that were quoted
    - Preserve literal values inside quotes
    - Expand variables ($VAR) based on quote context
    - Different behavior for single vs double quotes

âœ… [COMPLETED] Syntax validation
    - Check for invalid pipe usage (pipe at start/end, double pipes)
    - Check for invalid redirections (missing filenames)
    - Check for proper command structure (maybe in built-ins, otherwise let's leave it to execve :D)
    - Check for & standalone

ğŸ”§ [TODO] Logical operators parsing
    - Parse && (AND) and || (OR) operators
    - Build command chains with conditional execution

ğŸ”§ [TODO] Subshell parsing
    - Parse parentheses for subshell execution: (cmd1; cmd2)
    - Handle nested subshells

ğŸ”§ [TODO] Error recovery
    - Provide meaningful syntax error messages
    - Implement error recovery strategies

âš¡ EXECUTOR - "How do I run this?"
=================================
âœ… [COMPLETED] Built-in command recognition
    - is_builtin() function implemented
    - Builtin dispatch system working (exe_builtin())
    - Non-forkable builtin detection (cd, exit, export, unset)

âœ… [COMPLETED] Redirection handling for builtins
    - dispatch_builtin() implemented
    - Fork when needed for builtins with redirections
    - Proper handling of non-forkable builtins (cd, exit, export, unset)

âœ… [COMPLETED] Basic redirection infrastructure
    - setup_redirections() implemented in redirection.c
    - handle_input_redirection() for < (WORKING)
    - handle_output_redirection() for > and >> (WORKING)
    - File opening with proper flags and permissions

ğŸ”§ [CRITICAL] Built-in implementations - NEEDS FIXES
    âš ï¸  builtin_echo(): PARTIAL - Only handles single -n flag, needs multiple flag support
    âš ï¸  builtin_cd(): BASIC - Works for paths, missing HOME and OLDPWD (cd -, cd with no args)
    âœ… builtin_pwd(): WORKING - Correctly implemented
    âœ… builtin_env(): WORKING - Prints environment variables
    âš ï¸  builtin_exit(): BASIC - Works but needs exit code validation and error handling
    ğŸ”§ [TODO] builtin_export(): Not implemented yet
    ğŸ”§ [TODO] builtin_unset(): Not implemented yet

âœ… [COMPLETED] External command execution infrastructure
    - PATH resolution implemented (path_utils.c)
    - Command searching in PATH directories
    - exe_single_cmd() dispatcher for single commands

ğŸ”§ [TODO] External command execution
    - fork() and execve() for external programs
    - Handle command not found errors (exit 127)
    - Handle permission denied errors (exit 126)
    - Proper process management and exit status collection

ğŸ”§ [TODO] Pipeline execution
    - Create pipes between commands
    - Handle multiple processes in pipeline
    - Wait for all processes and collect exit codes
    - Note: Currently shows "pipelines not yet implemented" message

ğŸ”§ [TODO] Heredoc implementation
    - handle_heredoc() stub exists but not implemented
    - Read input until delimiter is found
    - Handle variable expansion in heredoc (if required)
    - Create temporary files or use pipes

ğŸ”§ [TODO] Wildcard expansion
    - Use glob() function for * expansion
    - Handle no matches (return literal *)
    - Sort expanded filenames

ğŸ”§ [TODO] Logical operators execution
    - Implement && (execute next only if current succeeds)
    - Implement || (execute next only if current fails)
    - Handle short-circuit evaluation

ğŸ”§ [TODO] Signal handling
    - Handle Ctrl+C (SIGINT) - interrupt current command
    - Handle Ctrl+\ (SIGQUIT) - ignore in interactive mode
    - Handle Ctrl+D (EOF) - exit shell gracefully

ğŸ”§ [TODO] Subshell execution
    - Create child process for subshell
    - Execute commands in isolated environment
    - Return subshell exit status

ğŸ”§ [TODO] Error handling
    - Set $? exit status correctly
    - Handle command not found (127)
    - Handle permission denied (126)
    - Handle other execution errors

ğŸ› ï¸ INFRASTRUCTURE & UTILITIES
=============================
âœ… [COMPLETED] Memory management
    - Implemented memory arena for efficient allocation
    - Arena-based string functions (ar_strdup, ar_substr, ar_strjoin, ar_split)
    - Auto-extending arena when needed
    - Memory alignment for optimal performance
    - Reset functionality for command-by-command reuse

âœ… [COMPLETED] Shell initialization
    - shell_init() and related infrastructure in shell_init.c
    - Shell structure management
    - Environment handling setup

âœ… [COMPLETED] Path utilities
    - Command resolution in PATH directories
    - Path searching and validation (path_utils.c)

âœ… [COMPLETED] Shell utilities
    - Helper functions in shell_tools.c and shell_utils.c
    - Command table management
    - Token processing utilities

ğŸ”§ [TODO] Advanced features (bonus)
    - Command line editing with readline
    - Tab completion for commands/files
    - Prompt customization

ğŸ§ª TESTING & VALIDATION
=======================
âœ… [COMPLETED] Basic manual testing
    - Tokenizer tested with various inputs
    - Parser tested with command structures
    - Variable expansion tested

ğŸ”§ [TODO] Unit tests
    - Test tokenizer edge cases
    - Test parser with complex command structures
    - Test each built-in command individually
    - Test redirection combinations

ğŸ”§ [TODO] Integration tests
    - Test complete command execution flow
    - Test error handling and edge cases
    - Test memory management with valgrind
    - Test redirection + pipeline combinations

ğŸ”§ [TODO] Comparison testing
    - Compare behavior with bash
    - Test subject requirements compliance
    - Test bonus features if implemented
    - Edge case validation

ğŸ“‹ CURRENT STATUS (Updated: October 5, 2025)
============================================
âœ… Tokenizer complete with arena memory management
âœ… Quote handling with type differentiation implemented  
âœ… Parser base functionality complete with arena memory
âœ… Memory arena infrastructure complete and integrated
âœ… Variable expansion with quote context awareness (expand_variable_name())
âœ… Redirection parsing (>, >>, <, <<) in parser
âœ… Redirection execution for input (<) and output (>, >>) - WORKING!
âœ… Built-in command framework with fork management
âœ… Path resolution system working (exe/path_utils.c)
âœ… Single command execution dispatcher
âœ… Development tooling enhanced (Makefile with valgrind/cppcheck)
âš ï¸  Built-in commands: basic implementations exist, need enhancements
â³ Heredoc execution (stub exists, not implemented)
â³ Pipeline execution (recognized but not implemented)
â³ External command execution (infrastructure ready, execution pending)

ğŸ¯ NEXT IMMEDIATE STEPS - UPDATED PRIORITIES
============================================
ğŸš¨ CRITICAL (Complete Core Functionality):
1. Implement external command execution with fork/execve
2. Complete heredoc implementation (handle_heredoc())
3. Implement pipeline execution (execute_pipeline())

ğŸ”¥ HIGH PRIORITY (Enhance Built-ins):
4. Enhance builtin_cd() - Add HOME directory support (cd with no args)
5. Enhance builtin_cd() - Add OLDPWD support (cd -) and PWD updates
6. Enhance builtin_echo() - Handle multiple -n flags correctly
7. Enhance builtin_exit() - Add exit code validation and error handling

â­ MEDIUM PRIORITY (Complete Built-ins):
8. Implement builtin_export() - Set/export environment variables
9. Implement builtin_unset() - Remove environment variables
10. Add error handling for command not found (exit 127)
11. Add error handling for permission denied (exit 126)

ğŸ’¡ POLISH & FEATURES:
12. Implement variable expansion for $? (exit status)
13. Add comprehensive error messages
14. Handle signal interrupts (Ctrl+C, Ctrl+\, Ctrl+D)
15. Advanced features and bonus items

ğŸ“ NOTES & INSIGHTS
===================
- Follow 42 Norm: functions â‰¤25 lines, â‰¤80 chars per line
- Add comprehensive comments for learning
- Test each component thoroughly before moving to next
- Keep clean separation between lexer/parser/executor
- Built-ins are recognized at EXECUTION time, not parsing time
- All command names are WORD tokens regardless of type (built-in vs external)
- Non-forkable builtins (cd, exit, export, unset) must run in parent process
- Forkable builtins (echo, pwd, env) can fork when redirections are needed

ğŸ”§ DEVELOPMENT TOOLS:
- Enhanced Makefile with colored output and comprehensive targets
- Valgrind integration with file descriptor tracking (--track-fds=yes)
- Comprehensive cppcheck static analysis (--enable=all --inconclusive)
- Professional development workflow established

ğŸ§ª QUALITY ASSURANCE:
- Code structured with clear separation of concerns
- Memory management validated with arena system (no leaks detected)
- Redirection system tested and working for basic cases
- Variable expansion implemented with quote awareness

ğŸ“Š PROJECT STATISTICS:
- Lexer/Parser: ~90% complete
- Executor: ~40% complete (basic framework + redirections done)
- Built-ins: ~50% complete (basic versions exist, need enhancements)
- Overall: ~60% complete

ğŸš€ Remember: "Make it work, make it right, make it fast!"
ğŸ’¡ Current Focus: Complete core execution (external commands, pipes, heredoc)
ğŸ¯ Next Phase: Polish built-ins and add comprehensive error handling
âœ¨ Final Phase: Signal handling, bonus features, and extensive testing
